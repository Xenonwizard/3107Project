CREATE OR REPLACE MODEL `flowing-gasket-454406-k2.dataset1.dnn_model_test`
OPTIONS(
  model_type='dnn_classifier',
  input_label_cols=['label'],
  activation_fn='relu',
  hidden_units=[64, 32],
  max_iterations=5
) AS
SELECT
  text_,
  label
FROM (
   SELECT *,
         ROW_NUMBER() OVER (PARTITION BY label ORDER BY RAND()) AS row_num
  FROM `flowing-gasket-454406-k2.dataset1.table1`
WHERE
  label IS NOT NULL AND text_ IS NOT NULL
)
WHERE row_num<=10000;